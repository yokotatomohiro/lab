量子アニーリングを用いた効率的な組合せ最適化

abstract
最初に市販された量子コンピュータは, 現在の技術を用いてヒューリスティックにNP困難な問題に取り組むツールを提供した. 
しかし, 現在の量子コンピュータが古典的なコンピュータよりも量子的優位性があるものをすでに提供しているかは不明です. 
この記事では, 二つのNP困難のグラフ問題, 特にクラーク検出とグラブ分割に対するD-Wave 2X量子アニーラの性能を評価する. 
このために, 量子アニーラに適したQUBOおよびIsingハミルトニアンとしての定式化を提供し, あるグラフのテストセットに対して様々な量子ソルバー(Sapi, QBSolve, D-waveが提供するQSage)と現在の古典的アルゴリズム(METIS, シミュレーテッドアニーリング, 3rd)との性能を比較する. 
グラフのサイズが小さい場合, 得られた最良の解の質は同程度であるにもかかわらず, 古典的な方法は依然として計算時間の点で量子アニーラよりも優れていた. 
それにもかかわらず, D-Wave 2Xチップに埋め込むことが問題サイズに制限があるために, 前述した発見は量子アニーラで解けるほとんどの問題に当てはまる. 
D-Wave 2Xアーキテクテャに合うように特別に設計された例では, 古典的は方法よりも計算時間が大幅に早くなる. 

1. Introduction 
最初の商用的量子コンピュータの利用可能性は, コンピューティング, 物理学およびアルゴリズム設計の分野において新たな多くの挑戦をもたらした. 
特に新しい装置は, 現在の技術をヒューリスティックに用いることでのみ解けるNP困難な問題を解くことができるツールを提供する. 
だが, 利用可能な量子コンピュータが実際に古典的な方法を超える利点を提供できるかどうかは依然として論争されている. 

この記事では, 二つのNP困難のグラフ問題(最大クリーク検出および分割(エッジカットおよびch-))についてD-Wave2X量子コンピュタの性能を調べる. 
第一の問題は, 与えられたグラフに対するフルコネクトのようなサブセットを見つけることを問題としている. 
後者は通常, 全ての成分間のエッジ数が最小になるように, グラフをあらかじめ指定された数の成分に分割することを目的としている. 
この記事で調べたグラフの分割のもう一つの変形はcore-halo(CH)分割です. 

様々な古典的な発見方法が両方の問題を妥当な時間内で高精度に解くことが知られている. 
異なるアプローチに従うものがD-Wave Systems Inc.が開発した量子アニーラである. 
簡単に言えは, 量子アニーラは古典的なシミュレーテッドアニーリングのアルゴリズムをハードウェアとして実現したものだが, エネルギーもしくは目的関数のランドスケープを探すために量子効果を利用するという例外がある. 
シミュレーテッドアニーリングで提案されたランダム移動と同様に, 量子アニーラでは局所最適解を回避し, 物理システムの低エネルギー配置を見出すために回避量子揺らぎを利用している. 
量子ビット(qubit)は, D-Waveチップ上の一連の超伝導ループを介して実現される. 
各ルーブは, アニーリングが完了してシステムが古典的になるまで時計回りおよび反時計回りの両方向に二つの重畳電流を介して同時に0および1ビットの両方に符号化する. 

D-Waveチップの特定の成分により, このデバイスは与えられた定数によって重み付けられた線形および二次量子ビット寄与の合計からなる制約のない目的関数を最小化するように設計されている. 
正確には次のハミルトニアンを最小化することを目的としている. 

(式)

aは実数, Vは集合, Eは空間
上記形式のハミルトニアンを最小化するために量子コンピュータを使う利点は, 古典的には組み合わせ問題はNP困難であるが, その問題を物理システムに写像することによって, システムがどのようにエネルギー最小値にそれ自身を配置したかを観察することによって解を読み取ることができる. 
特に, 計算時間は問題の大きさと無関係であり, 基本的に決定論的な既存のデジタルコンピュータとは異なり, 量子アニーリングは基本的には確率的です. そのため最小化の手順は実験的性質より, 解は常に同一ではない. 

この記事は次のように構成されている. 二章ではQUBO(二次無制限二値最適化)とIsingハミルトニアンの紹介をし, D-Waveのアーキテクチャについて説明する. 
さらに, 量子ツール(Sepi, QBsolv, Qsage）を, この研究で利用する古典的なアルゴリズム(シミュレーテッドアニーリング, METIS, Gurobi)と同様に記述する. 

三章では最大クリーク問題を調べる. 
QUBOの定式化, グラフ分割アルゴリズムおよびD-Waveで最大クリーク問題を解くために使用するパラメータについて説明する. 
さらに三章では, 小さいグラブとD-Waveの量子ビットアーキテクチャに適合するように特別に選択されたグラフとの比較研究を示す. 
比較は古典的な方法(量子断熱進化, 特殊なシミュレーテッドアニーリング), fmcクリークヒューリスティックおよび厳密ソルバー, Gurobi)およびD-Waveによって提供されている前述のソルバーを含む.

四章では, エッジ分割とCH分割と呼ばれる二種類のグラフ分割に焦点を当てる. 
これはQUBOとIsingの両方の公式でハミルトニアンを導き出し, 最適な分割解でハミルトニアンの大域的最小値が達成されることを保証するハミルトニアンの重みに関する条件を証明する. 
ランダムグラフを使用して, 四章ではエッジカットとCH分割問題の両方について, 計算時間と計算された分割の質の観点から, 前述した全ての古典的ソルバと量子ソルバを評価する. 
D-Waveデバイスの埋め込み時間とアニール時間を比較する. 

最後に五章では結果の議論をまとめ, 量子的優位性はD-Waveチップに合わせた場合のみ観測できるが, 一般形式の問題の場合には観測できないと主張している. 

本項では, G=(V, E)はグラフを意味し, Vはn個の頂点の集合を意味し, Eは無向辺の集合を意味している. 
集合Vの基数を|V|として表現する. 

2. Methods
この章ではD-Waveデバイスが解ける問題である二次整数計画法を紹介する. 
このような二次プログラムの二つの異なる定式化を提供し, 二つの間での変換方法を示す. 
次に, この章では二次計画法を量子コンピュータに提出するためにD-Wave.Incが提供する三つのツールについて簡単に説明する. 
そのために, 入力フォーマット, 使用されるソルバーとそのインターフェース, そして利用可能な後処理方法と出力フォーマットを扱う. 

2.1 Ising and QUBO formulations
D-Waveデバイスは, 二次整数計画法と呼ばれる問題のみを解くように設計されている. 
それはn個の変数q_{i}, i\in {1,\dots , n}を操作することで, 線形および二次相互作用を可能にし, 総和は次の式のようになる. 

(式1)

a_{i}は実数であり線形の重みであり, a_{ij}は実数であり二体の重みを表し事前に利用者によって設定される. 
前述した二次最小化計画法には二つの種類がある. 
QUBOの定式化では, 全ての変数はq_{i}={0,1}の二値を取り, Ising定式化ではq_{i}={-1,1}を取る. 
どちらの定式化でも, (式1)の二次計画法の項は変化しない. 

慣例として, QUBO問題は文献においてしばしば重みQ_{i,j}は下側(または上側)対角行列として述べられている. ここで, 対角成分は線形の重みと対応し, 非対角成分は二次結合と対応する. 
Ising問題では線形の重みをベクトルhとして与え, 下側(または上側)対角行列J_{ij}(i<j(i>j))で表す.

2.2 Conversion of Ising to QUBO and vice versa
QUBOとIsingの二次整数計画法は等価である. 二つの違いは変数q_{i}の取りうる値だけであり, それゆえに一つの公式を他の公式に変換することが可能である. 
これは次のようにして行われる. 

線形重みQ_{ii}と二次重みQ_{ij}(i<j)を持つQUBO問題が与えられたとする.
この時, 次のように設定することで等価なIsing問題となる.

(式)

同様にして, 線形重みのベクトルhとカプラ行列JをもつIsing問題を次のように定義することでQUBO問題へと変換できる. 

2.3 Qubit architecture and chains of qubits
D-Waveの量子コンピュータは, 特定のグラフアーキテクチャ上に配置された約1,000量子ビットを操作する. 
利用可能な量子ビットの正確な数は製造誤差によりチップごとに異なる. つまり, 想定される量子ビットの数がデバイスごとにわずかに少ないことを意味する. 
量子ビットは12セルの格子状に相互接続された4×4の二部グラフセルからなるチップ上のキメラグラフアーキテクチャで配置されている. 

量子ビットの特定のアーキテクチャは二つの重要なことを意味している. 
一つは　チップ設計が二つの量子ビットのペアワイズ寄与を可能にしている. 
線形寄与と一緒に, これは目的関数の形式をD-Waveで解くことができる(式1)の二次整数計画法として動機づけている. 

二つ目は, 理論的には(式1)は任意の二つの量子ビットq_{i}, q_{j}の間にはペアワイズ相互作用を含むが, これは実際には当てはまらない. 
D-Waveチップ上の物理的量子ビットはいずれも4×4の二部グラフセル内でのみ辺を持っており, さらに, おそらく隣接セルの量子ビットへさらに接続するので, 対相互作用は実際には非常に制限される. 
したがって, 実際には関連する二つの量子ビットが物理チップ上にすでに隣接していない場合には, QUBOまたはIsing入力問題で指定されたペアワイズ相互作用を様々な量子ビットを通して再ルーティングしなければならない. 
物理チップ上で実際に隣接していない二つのビットq_{i},q_{j}を接続するために使用されるこれらの追加量子ビットはチェーンと呼ばれる. 

チェーンの存在は三章, 四章で重要な役割を果たす二つの重要な結果をもたらす. 
一方で, チェーンの必要性は二次計画法で利用可能であろう量子ビットを使い果たしてしまう. つまり, 多くのベアワイズ相互作用を含む問題では, 約1,000量子ビット以下しか利用できない. 
完全グラフの最悪の場合では, 任意のペアワイズカプラが望まれる時(式1)では48量子ビットしか利用できない. 
一方で, 量子アニーリングプロセスの確率的性質のために, D-Waveによって返される解は必ずしも同一ではない. 
チェーン内の全ての量子ビットは構成によって(式1)の同じ単一ビットを符号化するのでどの解決法でも一貫した値を取るべきであるので, これは特定の場合に使用される全てのチェーンにとって問題である. 
この現象は ,チェーンの破れと呼ばれている. 
もしチェーンが壊れた場合には特定の量子ビットにどの値が割り当てられているかは明確ではないので, 後処理技術が必要になる. 
当然ながら, 利用者が解きたい二次計画よりも高いカプラ重みを割り当てることで, チェーンが破損しないようにすることができる. 
しかし, この場合, 量子アニーラは実際の二次計画法のいくつかのカプラを侵害するという犠牲を払うことで, 全てのチェーンが満たされる(すなわち, 一つの一貫した値を有する)ことを保証するように暗黙的に調整され, 実行不可能な解決策につながる. 
満足のいくチェーンを保証することと, ユーザが解きたい実際の二次計画に十分な重みを置くことの間にはトレードオフの関係があり, さらなる研究が必要である. 

2.4 D-Wave solver
D-Wave Inc.は(式1)で与えられたインスタンスを実装するためのいくつかのソルバを提供しており, ソルバは量子コンピュータに提出し, それが返す解に必要な後処理手順を適用し出力をフォーマットする. 
この章ではこの論文で利用したD-Waveコンピュータへのインタフェースについて説明する. 

2.4.1 Sepi
C++およびpython用のインタフェースはD-Wave Inc.によって提供されている. 
これらのインターフェースはD-Waveサーバへのインターネット接続の確立, IsingおよびQUBO形式での二次計画法の提出, および, 解の後処理を可能にする. 

最も重要なことに, sepiインターフェースはユーザーがD-Waveパラメータを自分で調節できることがある. 
これは, 量子デバイスが実行することになっている繰り返し回数を選択, 後処理のタイプ指定, キメラ物理グラフ構造へのIsingまたはQUBOの個々の埋め込み計算を可能にする. 
二次計画法自体は適切なデータ構造のベクトル(線形重みを含む)および行列(二次重みを含む)として提供され, 解はユーザーが適切と見なす方法で評価または処理できるベクトルとして返される. 
IsingとQUBOの両方の公式を解くためのsepiルーチンがあるが, Isingルーチンの方がより上手くいくように思われることに気がついた. 
同等のIsing式とQUBO式の間で変換するためのsepiルーチンが提供されているので, これは問題にはならない. 

ユーザは埋め込みグラフを完全に制御するので, キメラアーキテクチャに完全に適合するように設計された二次計画を提供することができる. 


