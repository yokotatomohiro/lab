Self-learning projective quantum Monte Carlo simulations gurided by restricted Boltzmann machines

S.Pilati, E.M.Inack, P.Pieri

abstract
QUMCアルゴリズムは, 量子多体系の基底状態特性をシミュレートするための最も強力な計算手法の一つである. 
しかしながら, それらはシミュレーションを導くために十分に正確な試行波動関数が使用される場合にのみの確率的である. 
標準的なアプローチでは, この波動関数は変分最小化を実行する別のシミュレーションで得られる. 
ここでは, 制約付きボルツマンマシンに基づく最適波動関数によって導かれるPQMCシミュレーションを実行する方法を示している. 
この適応波動関数は, 教師なし学習によってPQMCシミュレーションに沿って最適化され, 別の変分最適化の必要性を回避する. 
副産物として, この技法は基底状態波動関数の正確な解を提供する.
これは, 標準的な変分最適化のようにエネルギー期待値を最小化するのではなく, PQMCサンプルに関してKullback-Leibler発散を最小化することによって得られる.
この自己学習PQMC技術の高精度は, パラダイスのサイン問題のないモデル, すなわち強磁性量子イジング鎖に対して実装され, ジョーダン-ウィグター理論および低音限界で行われるループ量子モンテカルロシミュレーションの予測と非常に正確な一致を示している.

Introduction
虚数シュレディンガー方程式と拡散方程式の間の類似性は, 確率的に(典型的には大きな)ランダムウォーカーの母集団を発展させることによって量子多体系をシミュレートすることを可能にする.
これがいわゆる射影量子モンテカルロアルゴリズム(PQMC)の基本である.
これらのアルゴリズムは, 対応する波動関数が実数であり, 適切な根拠で非負であるので, これらが符号問題のないハミルトニアンの基底状態をシミュレートする時に特に効率的である.
固定ノード法と解放ノード法を使用すると, 符号問題が発生した場合でも, 特に一般的に計算コストが高いにも関わらず, 多フェミオンシステムでPQMCシミュレーションは正確な予測を提供する.
PQMCアルゴリズムは, 電子ガス, 分子システム, 液体および固体ヘリウム, 固体中の電子, 冷却ガス, 量子スピンおよび格子モデル, ならびに核物質を含む基本的な量子システムをシミュレートするために使用されてきた.
しかしながら, これらのアルゴリズムは, それらが構成空間の最も関連性のある領域に向かってランダムウォーカーを案内するために使用される十分に正確な試行波動関数を備えている場合にのみ効率的である.
この波動関数が含まれたいない場合, または十分に正確でない場合, PQMCシミュレーションの計算コストはシステムサイズに比例して指数関数的に拡大する.
様々な関連システムについて, 適切な波動関数の一般形の何らかの物理理論によって提供され, 詳細はエネルギー期待値の変分最小化を介してさらに調整することができる. 
しかし, 適切な理論が常に利用できるわけではなく, 変分最適化は非常に困難な計算タスクとなる可能性がある.
さらに, 波動関数の不正確な解答は, 特に多くの強相関および/または無秩序多体系の場合のように, 異なる位相が密接に競合する場合に, 偏った予測に繋がる可能性がある.
この問題は, 量子アニーラが複雑な最適化問題をどのように解くかをシミュレートするために量子モンテカルロ(QMC)アルゴリズムが使用されており, 断熱量子コンミューティングの分野で特に関連する.
実際, ハード最適化問題の典型的な例に対応するハミルトニアンは, ランダムイジングモデルの形で書くことができる. 
これらのモデルはガラス質の基底状態を特徴としており, 正確な仮説を推定するのは困難である.

量子スピンモデルの一般変分解答として, ある種の生成型ニューラルネットワーク, 具体的には制限付きボルツマンマシン(RBM)[図1, 上段]に基づく波動関数が最近提案されている.
彼らの表現力, もつれ合い特性, そいてより複雑なバージョンは, 現在非常に熱心な研究活動の主題である.
他の物理学にヒントを得たanstzが利用できないとき, それらは特に役に立つように見える.
本稿では, PQMCシミュレーションにおける波動関数としてそれらを使用する方法を示している.
以前の記事では, 一種の無制限ボルツマンマシンを模倣するニューラルネットワーク状態(図1, 下段)が導関数として採用されてきた.
参考文献[24]の場合, ニューラルネットワークパラメータは別の変分最適化を介して取得する必要があり, PQMCアルゴリズムは追加の隠れ変数のサンプリングでオーバーロードする必要があった.
ここでは, 教師なし機械学習アルゴリズムを使用して, ランダムウォーカー構成から直接PQMCシミュレーションに沿ってRBMをトレーニングできることを示している.
PQMCシミュレーション中に改善される適用導出関数を得て, 有限のランダムウォーカー母集団によるバイアスを完全に排除し, 統計的変動を劇的に減少させることを可能にする.
テストベットとしてALPSライブラリを用いて行われたJordan-Wigner理論とループ量子モンテカルロ(QMC)シミュレーションの正確な予測との比較をしながら, パラダイム的な符号問題のないモデル, すなわち低温度限界での強磁性量子イジングチェーンを考察する.
基底状態のエネルギーと, 上, 下, および強磁性量子限界点での平均磁化に関して優れた一致が得られる.
この仮説は, 変分エネルギーの一般な最小化ではなく, Kullback-Leiblerの発散を最小にすることによって開発される.

ここで考察したモデルでは, 自己学習によるPBM波動関数は, NetKetライブラリに実装されている確率的再構成アルゴリズムなどの高度な最適化手法にを使用した変分最小化によって得られるものと比較的同じくらい正確である.

この論文は以下のように構成されている. 第二章では我々が扱うモデルハミルトニアンを紹介し, PQMCアルゴリズム, PBM変分波動関数, そして適応教師なし学習手順を説明する. 
数値結果と以前の理論との比較は第三章に示されている.
第四章では, 我々の調査結果を要約し, 将来の可能性のある拡張について議論する.

2. METHOD
自己学習型PQMCシミュレーションのテストベッドとして, 次のように定義される一次元強磁性量子イジングハミルトニアンを考える.
(式1)
ここで, σ_j^xとσ_j^zは, 格子位置j=1,...,Nでスピンに作用する従来のパウリ行列を示す.
Nはスピンの総数であり, 我々はオープン境界条件を考慮する.
パラメータJ>0は最近傍スピン間の強磁性相互作用の強さを固定している.
以下では, エネルギースケールの単位としてJ=1を使用している.
Γとhはそれぞれ横磁場と縦磁場の強度である.
以下では, パウリ行列σ_j^zの固有状態を|x_j＞と表記する.
|x_j＞=|↑＞の場合, 固有値はx_j=1であり, |x_j＞=|↓＞の場合, x_j=-1となる.
x=(x_1,...x_N)であるN個のスピンの量子状態|x＞=|x_1x_2...x_N＞は本研究で考慮される計算上の基礎を形成する.
波動関数＜x|ψ＞=ψ(x)に対する量子状態を|Ψ＞と表す.

A. Projective Quantum Monte Carlo simulations
PQMCアルゴリズムは, 虚数シュレディンガー方程式を確率的に発展させることによって一般的なハミルトニアンの基底状態をシミュレートすることを可能にする.
基底状態の波動関数(通常は導波(または試行)は波動関数と呼ばれ, ψG(x)として示される)に適切な仮説を導入し, 積f(x,τ)=ψ(x,τ)ψG(x)とすると, アルゴリズムの精度と効率は大幅に向上し, 修正虚数時間シュレディンガー方程式に従って展開する.
この方程式は次のようになる.
(式2)
G(x,x',Δτ)は短い時間ステップΔτ(この論文ではh=1と設定)に対する想像上の時間グリーン関数である.
E_ref は数値を安定させるために導入された基準エネルギーである.

参考文献[48,49]の連続時間アルゴリズムを使用する. これにより, 有限の時間ステップ誤差を避けながら, 厳密な(修正された)虚数時間のグリーン関数\tilde{G}(x,x',Δτ)を確率的にシミュレートできる.
これはトロッター近似を使用して発生する.
これは, グリーン関数の正式なゼロ時間制約を使用し, 連続したシングルスピンプリップ間の時間間隔δτを適切にサンプリングすることによって達成される.
時間ステップΔτ内にさらにフリップすることがある.
修正虚数時間グリーン関数は標準的なマルコフ連鎖, すなわち列正規化遷移行列によって駆動される過程を定義しないので, シミュレーションは確率的に大きな集団のランダムウォーカーを進化させることによって実行されたければならない.
これらのウォーカーは, 構成スペースの更新と, それらが消滅または複製される分岐プロセスを受ける.
スピン配置の更新x'→xは修正された虚数時間グリーン関数に比例する確率分布からランダムに選択される.
導波関数は, 構成空間の関連領域への更新を支持する.
分岐過程では, 局所エネルギーがE_loc(x)である場合, ランダムウォーカーは加重係数w_x'に従って消滅または複製される.
この重みは遷移行列の列正規化を説明する.
E_refを動的に調整することによって, ランダムウォーカー母集団のサイズを所望の目標値N_wに非常に近く保つことができる. 
分岐プロセスを実装し, E_refを調整するために, 参考文献[51]の教科書レシピを使用する.

ここでスケッチされた連続時間PQMCアルゴリズムは参考文献でより徹底的に説明されており, そして我々はさらなる実装の詳細のためにそれらの参考文献に興味のある読者を参照する.
各ステップが短い時間ステップΔτに対応する多数のN_MCのモンテカルロステップを繰り返すことによって, 射影は長い虚数時間τ=N_MC Δτに達することができる.
虚数時間の極限では, ウォーカーはf(x,τ→∞)=ψ_0(x)ψG(x)に比較する確率分布でスピン配置をサンプリングする.
ここでψ_0(x)は基底状態の波動関数である.
基底状態エネルギーの偏りのない予測は, 式(3)の総和のモンテカルロ積分によって得られる.
ハミルトニアンと交換する他の観測量の基底状態期待値の偏りのない予想は, 類似の式で得られる.
ただし, ハミルトニアンと交換しない演算子O^の場合, 類似の式はいわゆる混合推定量を予測する.
一般に, 導波関数が基底状態の波と一致しない限り, これらは導波関数によるバイアスの影響をうける.
それにもかかわらず, 選択された計算ベースにおいて演算子O^が体格である場合, ＜ψ_0|O^|ψ_0＞/<ψ_0|ψ_0>に対応する純粋な推定量は標準的な順方向歩行技術によって計算することができる.(例えば, 参考文献[7]を参照).
正確な導波関数は前進歩行技術の計算コストを削除する.

ランダムウォーカーの母集団の最大数N_w→∞では, 上記のモンテカルロ推定値は偏りがなく, 統計的な変動によってのみ影響を受ける. これは統計的に減らすことができる.
有限のN_wの場合, 複製された歩行者間の誤った相関のために系統的な偏りが生じるかもしれない.
参考文献[16]では, 上の式でψG(x)=1に設定することに対応する導波関数を導入しない場合, この系統的バイアスを選択された値より低く保つために必要なランダムウォーカー母集団がひつようであることが確かに示された. 閾値はシステムサイズとともに指数関数的に増加する.
これは, 指数関数的に拡大する計算コストを意味する. 
その代わりに, 導波関数が厳密ならば, すなわちψG(x)=ψ_0(x)の場合, 局所エネルギーE_loc(x)は定数関数である.
これは分岐過程でのランダムウォーカーの消滅と複製を凍結し, 潜在的な偏りを排除する.
ψG(x)がψ_0の合理的な近似である場合, ランダムウォーカー数の変動は, ψG(x)=1で実行される単純なPQMCアルゴリズムの場合と比較してとにかく減少し, 正確なN_w→∞の極限への収束をはるかに速くする.

B. Boltzmann machines for PQMC algorithms
参考文献[24]では, 無制限ボルツマンマシンに基づく導波関数は, 少なくとも強磁性量子イジングチェーンについて, 必要とされるランダムウォーカー母集団を劇的に減少させるのに十分正確であり, 多項式スケーリング計算コストにつながることが示された.
驚くべきことに, これはたった三つの変分パラメータを最適化することによって達成された.
最適化されるべに少数の変分パラメータは, 参考文献の無制限アーキテクチャの主な利点である.
しかしながら, 無制限ボルツマンマシンを使用することは, 変分最適化の間[55], そして主に, PQMCシミュレーションの間に追加の隠れたスピンをサンプリングする必要がある.
実際, PQMCアルゴリズムは, 参考文献[5]で説明されているように, 可視スピンと隠れスピンのサンプリングを組み合わせて拡張する必要がある.
追加の隠れたスピンの非効率的なサンプリングは, 複製された歩行者の間でさらなる相関関係を導入する必要があり, それはより大きな有限N_wバイアスをもたらす.
この有害な効果は確かに, その後の隠れスピン配置間の統計的相関が大きい, 強磁性量子臨界点の近くで行われたPQMCシミュレーションで観測された.
この効果は強磁性量子イジングチェーンにおいて指数関数的にスケーリングする計算コストには繋がらなかったが, これはより挑戦的なハミルトニアンによってより有害であるかもしれない.

以下では, RBMに基づく導波関数によって有限N_wバイアスを排除できることを示している.
RBM anstzが提供する追加の利点は, 個別の変分最適化を必要とせずに, ランダムウォーカー母集団から直接教師なし学習機械を介して誘導関数の最低かを実行することである.
さらに, 無制限のボルツマンマシンとは対照的に, RBM ansatzは追加の古典的な隠れスピン変数をサンプリングする必要がない.
これにより, 隠れたスピンに対するモンテカルロの更新でPQMCアルゴリズムが過負荷になるのを避けることができる.
これら二つの利点は, 二つの設定で特に関連があると思われる.
フラストレーション効果が連続した隠れスピン配置間の相関性を高める可能性がある無秩序モデルのシミュレーションや, ハミルトニアンが時間的に変化し, 自動的に適応する導波関数によって量子アニーラのより効率的なシミュレーションを実行できる量子アニーリングシミュレーションダイナミクス.

ボルツマンマシンは, 確率論的サンプルの与えられた母集団に対応する確率分布を近似するためによく使用される生成型確率ニューラルネットワークである.
可視スピン変数xを超えて, それらはN_h個の追加の隠れスピン変数h_i=±1を含み, i=1,...,N_hをまとめて, 以下ではh=(h_i,...h_N_h)と表す.
確率分布は, 古典的なイジングハミルトニアンに対応するボルツマン重みP(x,h)の形で書かれる.
RBMの場合, この古典的なハミルトニアン関数は次のようになる.
(式4)
目に見える, 目に見える相互作用も隠された相互作用も許されないことに注意してください. 
代わりに, 全ての可視スピンは, 結合パラメータJ_ijを介して全ての隠されたスピンと相互作用する. 
図1の上部パネルに示されている二部全体接続性を用いて, それぞれ可視層および隠れ層と呼ばれる二つの層を得る. 










