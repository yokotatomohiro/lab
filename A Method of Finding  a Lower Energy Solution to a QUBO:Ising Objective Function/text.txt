A Method of Finding a Lower Energy Solution to a QUBO/Ising Objective Function
本項では, QUBO/Ising目的関数の低エネルギーの解を見つけるための新しい方法を紹介する.
これは, 様々な例でD-Waveから返されたサンプルに適用される.
この方法であるマルチキュービット補正(MQC)は, 作成に使用されたD波サンプルのいずれかと等しいか, それよりも少ないエネルギーのサンプルを作成する.
この方法を詳しく説明し, ３つのユースケースの結果を示して, そのメリットを実証する.

1. Introduction
D-Waveは, 断熱量子コンピュータである.
D-Waveによって対処される問題のクラスは, イジングモデルの目的関数Fに基づいている.
(式1)
ここでq_iはD-Waveによって返される量子ビット値であり, a_i[-2,2]およびb_ij[-1,1]はD-Waveに関連づけられた係数であり, それぞれ量子ビットと量子ビットカプラーである.

量子エラー修正, 特に量子アニーリング計算のエラー修正について, 広範な研究が行われている.
D-Waveは, 量子アニーリングコンピュータとも見なされる.
これらは, 量子アーキテクチャーの改善, より良い物理パラメータの修正の発見, および解決すべき量子問題へのエラー修正のための追加の物理量子ビットのエンコードに焦点を当てた量子エラー修正に取り組む.

量子アニーラの目的は, NP困難である式Fの絶対(グローバル)最小値を見つけることである.
より単純な問題は, NP完全問題であるFで表すことができる. この場合, 量子ビット値のパターンはグローバルミニマムではなく重要である.
NP完全問題の解決策は迅速に検証できるが, 量子ビット値のパターンを見つけることは困難である.
どちらの場合も, 計算中の解の正確さを検証することは非常に困難である.
非常に短い期間にわたって多数の量子ビットがそれぞれと相互作用するシステムのエラー修正が定義する複雑さは, 正確なエラー修正が何であるかを定義する問題を悪化させるだけである.
エラー修正をFの可能な限り最適な最小化を見つけることと定義した場合, 最小に近づく可能性があるのはヒューリスティックに過ぎないが, 到達したかどうかはわからない.
または, 計算を完了する前にビットパターンを修正するようにエラー修正を定義する場合, 問題が手に負えず, 計算が1ステップしか実行されない場合, ジレンマが発生する.
この作業では, 結果の量子ビット値パターンが正しことを期待して, Fの最小値を改善するための発見的アプローチに焦点を当てていく.

D-Wave 2xは、1152キュビット係数と3360カプラー係数を持つことができます。
D-Wave 2000Qは、最大2048個のキュービット係数と6016個のカプラー係数を持つことができます。
したがって、D-Waveを利用するには、係数のセットを考え出し、それらをD-Waveに送信する必要があります。
その後、D-Waveは少なくとも1セットのキュービット値を返します。
このセットは、ここではサンプルと呼ばれます。 要求は、複数のサンプルを対象とする場合があります。 ここでの典型的なリクエストは、1000サンプルになります。
D-Waveの目的は、Fを最小化するキュービット値のセットを返すことです
サンプルの目的関数Fの値は、サンプルのエネルギーと呼ばれます。
グローバルな最小エネルギーは1つしかありませんが、グローバルな最小エネルギーを持つサンプルは複数存在する場合があります。
このグローバルな最小エネルギーは、指定された係数セットのD波の基底状態に対応します。
D-Waveは、システム内の固有の量子/熱ノイズ、または基底状態に近い多数のわずかに高いエネルギー「アクティブ」状態の近接により、多くの場合、非最小エネルギー状態を返します。
これは質問につながります：
D-Waveが常に基底状態に対応するキュービット値を返さない場合、有用な計算を実行するために依存できるD-waveのプロパティ
以前、著者は、さまざまなテストケースでD-Waveの動作を特徴付けることにより、この問題に対処していました。

この論文では、量子ビットアニーラーの修正について、量子ビット値の修正の観点よりも結果の改善の観点から取り上げています。
このホワイトペーパーで定義されているヒューリスティックアプローチでは、量子アニーラーの返された結果に対して古典的に実行される後処理方法を使用します。
したがって、この方法は、量子アーキテクチャまたは任意の追加のアーキテクチャまたはアルゴリズムの改善とは無関係の任意の量子アニーラーで実行することができます。
この作業は、量子アニーラーの結果から可能な限りあらゆる情報を抽出し、最終結果の改善に活用することに焦点を当てています。
このメソッドの主な目標は、Fのグローバルな最小値を見つけることです。
副次的な目標、場合によってはより重要な目標は、Fのグローバルな最小値を表すキュービット値パターンを発見することです。

[4]で説明されているD-Wave改善アルゴリズムである単一キュービット補正（SQC）では、各キュービットが一度に1つずつ処理されました。
Fに対するキュービットの影響が計算され、影響が負の場合、その値はそのままになります。
しかし、影響が正の場合、キュービットの値は無効になり、したがって影響が負になり、全体のサンプルエネルギーが低下します。
これは、すべてのサンプルに対して個別に行われ、各サンプルのエネルギーを最小値であるがほとんどグローバル最小値ではないFの値に強制します。

このペーパーでは、より堅牢なアルゴリズムであるマルチキュービット補正（MQC）を紹介します。
サンプルで一度に1つのキュービットを個別に処理する代わりに、キュービットのグループをユニット、トンネルとして扱い、サンプルを相互に比較してこれらのトンネルを見つけます。
ここでの「トンネル」という用語は、[1]に示されている量子トンネルの概念に類似しています。
[1]では、量子トンネルは、量子ビット値のグループを同時に反転させ、非グローバル最小解をグローバル最小解に変更するD波の特性として実証されています。

したがって、トンネルは、影響値Iを持つグループキュービットとしてここで定義されます。
すべてのキュービット値が否定（反転）されると、Fの値に影響を及ぼします（Iで増加、Iで減少、またはまったく変更しない、I = 0）。
正の影響、Iは、トンネルキュービットを反転してFの値を下げることを意味し、負の影響はトンネルをそのままにすることを意味し、ゼロの影響はトンネルがサンプルを新しいサンプルに変更することを許可します Fの値が同じであるため、同じエネルギーのサンプルが追加されます。
グローバルにエネルギーが最小のサンプルの場合、ゼロインフルエンストンネルは基底状態の解に複数のサンプルを提供します。

ここでの前提は、
  1）D-Waveがグローバルミニマムまたはローカルミニマムをめったに見つけないこと、
  2）常に基底状態に近い何かを見つけ、さらに良いこと
  3）グローバルミニマムのコンポーネントまたはグローバルミニマムにつながるトンネルを見つけます。

このホワイトペーパーでは、MQCという手法を提示して、より最小のソリューション、場合によってはグローバルに最小のソリューションの構築につながるトンネルを見つけます。
ほとんどの場合ではありませんが、多くの場合、ソリューションがグローバルミニマムであることは証明できません。
1つのサンプルが別のサンプルよりも低いエネルギーを表していることのみが示されます。 このペーパーでは、MQCのメリットを示す3つのユースケースも紹介します。

2. Multi-qubit Corrention Method(MQC)
マルチキュービット補正の目的は、グローバル最小エネルギーであるとはいえませんが、グローバル最小エネルギーを持つサンプルを作成することです。
これは、サンプルのペアごとに新しいサンプルを作成し、サンプルの数を半分に減らすことによって行われます。
これは、サンプルが1つだけになるまで繰り返されます。
作成された各新しいサンプルは、作成された2つのサンプルのいずれかと等しいかそれよりも小さいエネルギーを持ちます。

2.1 New sample construction
新しいサンプルの作成は, AとBの２つのサンプルから始まる.
AとBを比較して, 量子ビットq_iAとq_iBが等しいかどうかを判断する.
q_iA=q_iBの場合, i \in S, q_iA \neq q_iBの場合, i \in D の２つの量子ビットインデックスのセットが作成される.
Dは, サンプルAからサンプルBへの変換を表すトンネルである.
これ自体は役に立たない.
ただし, AまたはBをより低いエネルギーのサンプルに変換するために使用できるサブトンネルを見つけるために使用される.
次のステップは, それらのサブトンネルを見つけることである.
DのサブトンネルTは, 全てのq_iおよびq_jで構成され, b_ij \neq 0 およぶi,j \in Dである.
したがって, Tは互いに推移邸に接続されているが, D内の他の量子ビットには接続されていないセット量子ビットの閉包である. 
これにより, トンネルT^kのセットが非ゼロ接続になる.
全てのT^kは互いに独立している(式2)
あるトンネルの量子ビットと別のトンネルの量子ビットの間にゼロ値カプラ(b_ij)はあまりない.
それでも, 全てのトンネルの結合はトンネルDと等しくなる(式3)
(式2)
(式3)
ここで, nはDで見つかったトンネルの数である.
T^kの影響はAまたはBへの寄与である.
AへのT^kのエネルギー寄与(その影響)は, Bへの寄与の負であることに注意してください.
サンプルAに対するT^kの影響は次のとおりである.
(式4)
q_jはサンプルAとBの両方で同じであることに注意してください.
また, (式)は上記の式には含まれないことに注意してください.
これは, T^kの量子ビットの値が反転するかどうかに関係なく同じ値を持ち, I_A^kとI_B^kの相対的な影響に影響しないためである.

最も低いエネルギーの一般的なサンプルは, サンプルAまたはBから取得できる.
トンネルT^kの影響がAに対して正の値を持つ場合, その量子ビット値が反転され, より低いエネルギーの新しいサンプルが生成される.
これが全てのT^kに対して行われ, I_A^k>0の場合, 結果はAに対して最小のエネルギーを持つ新サンプルCである.
それをBに対して行うと, 同じ最小エネルギーサンプルCが作成される.

2.2 Sample Aggregation 
前述したように, 物理量子マシン(D-Wave)から取得した全てのサンプルは, 単一のサンプルに集約される.
このサンプルのエネルギーは, 量子マシンから取得された最低エネルギーのサンプルと同じかそれ以下になる.
n個のサンプルが元々量子デバイスから取得された場合, 最初の集約ステップはn/2個の新しいサンプルが生成される.
O(log(n))ステップでは, n個のサンプルが1つのサンプルに削減される.

3. Multi-qubit Correction Example
D-Waveのサンプル補正は簡単で, D-Waveから返されたサンプルに直接アクセスするアルゴリズムに簡単に組み込むことができる.
次のサブセクションでは, 修正済みおよび未修正のD-Waveサンプルを使用する３つのアルゴリズムの結果を示す.
最初の例は, ランダムな値, 量子ビット, およびカプラー係数のセットに対してFを最小化する研究である.二番目の例は, [3]に示すD-Wave特性を拡張したもとである.
修正されていないD-Waveサンプル, SQC修正済みサンプル, MQC修正済みサンプル, および論理的に修正された仮想量子ビットを使用して, 量子ビットチェーン(仮想量子ビット)の動作を示す.
3番目の例は, MNISTデータセットの手書き数字でトレーニングされたキメラボルツマンマシン[2]が, 未修正, SQC修正, およびMQC修正D-Waveサンプルを使用してどれだけ機能するかを示している.

3.1 Example 1: Objective function with random coefficients
この例では, 全ての量子ビットおよびカプラー係数のランダム値で構成される1000のケースが作成される.
各ケースについて, BC州バーナビーのD-Wave 2Xから10,000個のサンプルがリクエストされる.
10,000個のサンプルは, サイズが大きくなる10個のサンプルサブセットになる.
前のセットの全てのサンプルを含む各サブセット. 
最初のサブセットの1000個のサンプルから開始し, 全ての10,000個のサンプルを含む10番目の最後のサブセットを使用して, 後続の各サブセットに1000個のサンプルを追加する. 
MQCは, 各ケースのサンプルの各サブセットに適用される.

表1は, サンプルのN番目のセットまでにMQCの最小サンプルに到達したケースの数を示しており, サンプルのより大きなセットでは改善が見られない.
列0Kに示されている4つのケースでは, 修正されていないD-Waveサンプルよりも改善が見られない.
MQCが最小のD-Waveサンプルを超えて改善しなかったことを示している. 
MQCは, 1000ケースのうち996ケースを改善し, 1000から10000のD-Waveサンプルを取得した. 

[4]を見ると, SQCがランダム係数を持つケースに適用されると, サンプルエネルギーの分布が低い値に向かってシフトするだけであることがわかる. 

この例で使用されている1000のケースのうち, SQCは976ケースのD波よりも小さい最小エネルギーを生成し, MQCは941ケースのSQCよりも小さい最小エネルギーを生成した.
SQCまたはMQCが低いエネルギーを返さなかった場合, それらのエネルギーは10^-14以内と同じであった.

3.2 Example 2: Virtual qubit characterisitics
仮想量子ビットの概念は, １つのして機能する物理量子ビットのグループである. 
したがって, 量子ビットの１つが真の値を持つ場合, 全ての量子ビットが真の値を持つ必要があり, 量子ビットの１つが偽の値を持つ場合, 全ての量子ビットが偽の値を持つ必要がある.
ここではIsingモデルが想定されているため, trueは1に相当し, falseは-1に相当する.
仮想量子ビットは, 物理量子ビットの12ビットチェーンで表される. 
ただし, 仮想量子ビットの量子ビットの値が全てtureまたはfalseになることはほとんどない. 

この分析のために, 仮想量子ビットが真か偽かを決定するために投票が使用される. 
trueの物理量子ビットの数がfalseの量子ビットの数以上である場合, 仮想量子ビットはtrueであると判断される. 
図1と図2は, 仮想量子ビットと, 仮想量子ビットで使用されるカプラー係数の値に対して, 仮想量子ビットが真である確率のプロットである. 
仮想量子ビットの全ての物理量子ビットは, 同じ量子ビット係数a_iと同じカプラー係数b_ijを持つ.
係数は2次元空間を表すために, プロットは曲線のファミリーである.
各曲線は, 単一のカプラー係数b_ijを表している. 
各曲線は, 確率と量子ビット係数a_iのプロットである.

図1のプロットに鋭い構造がないことは, 熱ノイズを示していることに注意してほしい.
D-Waveは12ミリケルビンで動作しているが, 量子ビットの振る舞いのプロットに見える十分な熱ノイズがある. 
これは, SQCで修正されたサンプルと修正されていないサンプルの両方に当てはまる. 
しかし, 図2のプロットは明らかにシャープである. 
図2bは, 絶対ゼロでの理論的に完全なD波のプロットである. 
明らかに, これを実際のハードウェアに実装することは不可能である.
ただし, MQCはD-Waveサンプルの後処理(エラー修正)により,これを実現できるようである.
図2aと2bはほぼ同じであることに注意してほしい. 
MQCプロットデータの各ケースのエネルギーが計算され, 同じケースの理論的に完全なD波と同じ基底状態エネルギーを持ち出した.
違いは, 理論的な結果が全ての可能な基底状態の結果を徹底的に計算して, より詳細なプロットを提供するという事実によるものである.
MQCは, プロットの統計を計算するために40の仮想量子ビットのみを使用したため, それほど詳細ではない. 

3.3 Example 3: Chimera Boltzmann machine
BC州バーナビーのD-Wave 2000Qの2048量子ビットにニューロンをマッピングすることにより, 2048ニューロンのキメラボルツマンマシンニューラルネットワークが形成された. 
100個のMNIST画像(28×28ピクセル)でトレーニングし, 別の100個のMNIST画像でテストをした. 
ニューラルネットワークは, サイズ784の入力層, 2048ニューロンの隠れ層, サイズ10の出力層の３つの層で構成されていた. 
これは現実的な人口ニューラルネットワークではないかもしれないが, その目的は, サンプル補正を使用してこのスタイルのアルゴリズムをD-Waveでテストすることである. 

図3は, このニューラルネットワークが, ニューラルネットワークの重みのみ更新を計算するために使用される未修正サンプル, SQC修正サンプル, および,MQC修正サンプルを使用してトレーニングデータをどの程度学習するかを示したプロットである.
プロットは, SQCまたはMQCで修正されたサンプルの方が, 修正されていないサンプルよりもニューラルネットワークがより迅速に学習することを示している. 
プロットはまた, 全ての方法が非訓練データの認識に劣っていることを示している.
これは, 隠れ層で非常に多くのニューロンを使用しているため, ニューラルネットワークが訓練データを過剰適合していることを示している. 
SQCはトレーニングのMQCと同様に, おそらくニューラルネットワークの重みの単一セットからのD-WaveサンプルがSQCとMQCの両方の単一の最小サンプルに修正されるという事実のためである([4]参照).
この理由には, 更なる研究が必要である.

4. Conclusion
ほとんどの場合、D-Waveによって返される結果を改善する方法（MQC）が提示されています。
現時点では、結果を改善するだけであり、必ずしもそれを修正するわけではないと主張することができます。
実装は簡単です。
2.67Ghz Intel i7では、10,000サンプルが3.87秒で最適なサンプルに、1,000サンプルが0.44秒で削減されます。 現在の時間と比較すると、1000サンプルでは約2秒、10,000サンプルでは6〜8秒のリモートD-Waveから結果を取得するのに比較的時間がかかります。
セクション3.3では、MQCがキメラボルツマンマシンでSQCと同様に実行され、トレーニングレートの点でD-Waveのみよりもはるかに優れていることが示されました。
3.2では、MQCは、D-Waveの結果を、試行されたすべてのケースで目的関数のグローバル最小値に修正するために古典的に計算できる問題で実証しました。
また、3.1では、MQCをより一般的な目的関数（ランダム係数）に適用して、古典的に計算することが不可能な問題について、ほぼすべての場合（99.6％）にD-Waveによって返される結果を改善しました 。
常に目的関数のグローバルな最小値を取得することは証明できませんが、D-Waveだけよりも確実に最小の解を生成することが示されています。
MQCは、断熱量子アニーリングコンピューターの量子エラー訂正の有用な形式であることが実証されています。
