%%「論文」，「レター」，「レター（C分冊）」，「技術研究報告」などのテンプレート
%% v3.2 [2019/03/19]
%% 1. 「論文」
\documentclass[paper]{ieicej}
%\usepackage[dvips]{graphicx}
%\usepackage[dvipdfmx]{graphicx,xcolor}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{textcomp}
\usepackage{latexsym}
\usepackage[fleqn]{amsmath}
\usepackage{amssymb}

\setcounter{page}{1}

\field{A}
\jtitle{イジング計算機での利用に向けた$l1$ノルムのQUBO形式について}
\etitle{QUBO formulation of l1-norm for Ising-type computers}
\authorlist{%
 \authorentry{横田 知大}{Tomohiro Yokota}{埼玉}\MembershipNumber{111111}
 %\authorentry{和文著者名}{英文著者名}{所属ラベル}\MembershipNumber{}
 %\authorentry[メールアドレス]{和文著者名}{英文著者名}{所属ラベル}\MembershipNumber{}
 %\authorentry{和文著者名}{英文著者名}{所属ラベル}[現在の所属ラベル]\MembershipNumber{}
}
\affiliate[埼玉]{埼玉}{Saitama}
%\affiliate[所属ラベル]{和文所属}{英文所属}
%\paffiliate[]{}
%\paffiliate[現在の所属ラベル]{和文所属}

\begin{document}

\begin{abstract}
  本稿では量子アニーリングを含むイジングモデルを用いたアニーリング法においてスパース推定を可能にするために、近年ReLUタイプ関数のQUBO形式を導出するために用いられたLegendre変換とWolfeの双対定理を利用した。さらに$l1$ノルムに対してこれらの変換を素朴に適用した場合、余分な変数も現れることが明らかになった。最終的に余分な変数を取り除くことで、より簡略化されたQUBO形式を導出する。
\end{abstract}
\begin{keyword}
%和文キーワード 4〜5語
\end{keyword}
\begin{eabstract}
%英文アブストラクト 100 words
\end{eabstract}
\begin{ekeyword}
%英文キーワード
\end{ekeyword}
\maketitle

\section{はじめに} 
近年、最適化問題の近似解を得ることに特化したアニーリングマシンが開発・提供されており、代表的なものにカナダのD-Wave.Incの''D-Wave 2000"や富士通の''Digital Annealer"、日立の''CMOSアニーリングマシン"などがある。最適化問題は、データマイニングや機械学習などの様々な分野で利用されている。特に、量子アニーリング法は門脇と西森によって提案され、同様の考え方をもつ断熱量子計算の考え方が注目を集めた。近年では実用化のための研究が行われており、
アニーリングマシンのハードウェアはイジングモデルのハミルトニアンを基にしているので、最適化問題のコスト関数をQUBO形式に変換する必要がある。連続変数については二進数展開を行うことでイジングタイプの変数に変換することができるが、コスト関数を直接QUBO形式に再定式化する系統的な導出方法は示されていない。しかし、論理ゲートを含むいくつかのものに対してはLucasによって再定式化がされている。近年では、Legendre変換を用いた$q$-loss関数のQUBO形式での導出が行われた．また，近年発表されたReLUタイプ関数のQUBO形式での導出ではLegendre変換だけでは不十分であり，新たにWolfeの双対定理を用いて導出を行っていた．

本稿で導出を行うl1ノルムは$q$-loss関数やReLUタイプ関数のようにコスト関数のペナルティとして用いることで解に''スパース性"を与えることができる．スパース推定は画像処理や機械学習の分野で広く利用されており，データ数の削減や高次元で複雑なデータから関連のあるデータのみを抽出できることからとても重要である．l1ノルムに対するQUBO形式の導出はすでにされており、本稿では導出の概要についての説明、およびスパース推定への応用に関して記述する。

・l1ノルムに対するQUBO形式の導出はすでにされている。本稿では、導出の概要について説明し、スパース推定への応用に関して記述する。

本稿の構成は次のようになる。まず第二章ではl1ノルムについての説明と利用例についての説明を行う。第三章ではQUBO形式とイジングモデルについての説明を行う。第四章では先行研究で行われた$q$-loss関数のQUBO形式への変換と導出に用いられたLegendre変換についての説明を行う。第五章ではReLUタイプ関数のQUBO形式を導出する際に追加で用いられたWolfeの双対定理についての説明とl1ノルムに対してLegendre変換とWolfeの双対定理を素朴に適用しることでQUBO形式への変換を行う。第六章では、第五章で導出された数式を見直すことで、余分な変数の削減を行う。第七章では、まとめと今後の展望について述べる。


\section{l1ノルムとスパース推定}
スパース推定とは、多くのパラメータのうちほとんどが$0$で、ごく一部のみ非$0$の値をとるように推定する方法である。スパース性を持つ推定方法の代表的なものにLeast Absolute Shrinkage and Selection Operator(LASSO)がある。LASSOでは、次の式をコスト関数としてコストが最小となるような回帰係数ベクトル$\beta$を推定をする。
\begin{eqnarray}
 S_{\lambda}(\beta) &=& \frac{1}{2n}\|y-X\beta\|^{2}_{2} + \lambda\|\beta\|_{1} \label{lasso}
\end{eqnarray}
ここで、$y$は$y\in\mathbb{R}^{n}$次元の観測ベクトル、$X$は$X\in\mathbb{R}^{n\times p}$次元の計画行列、$\beta$は$\beta\in\mathbb{R}^{p}$の回帰係数ベクトル、$\lambda$は$\lambda >0$の正則化パラメータである。LASSOのコスト関数は最小二乗法のコスト関数に$l_{1}$ノルムを加えた単純な形であり、最小二乗法と比較して、汎化性能が高く過学習を抑えることができる。

\section{QUBO形式とイジングモデル}
一章で説明したように，アニーリングマシンはイジングモデルという物理モデルがハードウェアとして実装されており，アニーリングを高速で実行することで近似最適解を出力する．イジングモデルは次のエネルギー関数で表現される．
\begin{eqnarray}
 H = \sum_{i\neq j}{J_{ij}\sigma_{i}\sigma_{j}}+\sum_{i}{h_{i}\sigma_{i}}, \label{Ising_model}
\end{eqnarray}
ここで，$\sigma_{i}$は$\sigma \in \{ -1,+1\}$の入力変数であり，$J_{i,j}$は二体相互作用のパラメータ，$h_{i}$は一体相互作用のパラメータである．アニーリングマシンに相互作用のパラメータ$J_{i,j},h_{i}$を与えることでエネルギーが最小となる$\sigma$の組み合わせ出力する
\subsection{QUBO形式}
最適化問題を二値変数$\sigma\in\{-1,+1\}$を用いたイジングモデルに直接変換することは難しい．そこで，$\sigma$の代わりに$q\in\{0,1\}$を用いた形式にする．これはQUBO(Quadratic Unconstrained Binary Optimization)形式と呼ばれ、エネルギー関数は次のように表される．
\begin{eqnarray}
 H = \sum_{i\neq j}{\widetilde{J}_{i,j}q_{i}q_{j}}+\sum_{i}{\widetilde{h}_{i}q_{i}}, \label{QUBO_model}
\end{eqnarray}

\section{先行研究：$q$-loss関数のQUBO形式での導出}
この章では先行研究で行われた$q$-loss関数のQUBO形式での導出について紹介する。$q$-loss関数は式と定義され、グラフの外形は図のようになる。
\begin{eqnarray}
 L_{q}(m) = \min{[(1-q)^{2},(\max{[0,1-m]})^{2}]},
\end{eqnarray}
ここで、$q\in(-\infty,0]$のパラメータであり、$m$は実変数である。

分類問題において、この$q$-loss関数をコスト関数のペナルティ項と用いることで、識別境界から大きく離れたラベルノイズが存在してもロバスト性を確保するすることができる。

式は$\min$関数と$\max$関数が含まれているため二次形式ではなく、またQUBO形式でもない。そこで、Legendre変換を用いることで式をQUBO形式に変換する。次の節ではLegendre変換についての説明を行う。

\subsection{Legendre変換}
この節では、Legendre変換についての簡単な説明を行う。$f_{L}(x)$を凸関数とするとき、次のような関数$f^{*}_{L}(\eta)$を考える。
\begin{eqnarray}
 f^{*}_{L}(\eta) &=& \min{\{\eta x-f(x)\}} \\
                 &=& -\max{\{f(x)-\eta x\}}
\end{eqnarray}
$\eta$は追加変数であり、$x$に関する関数から$\eta$に関する関数へと変換している。ここでこのような$f(x)_{L}$から$f^{*}_{L}(\eta)$への変換をLegendre変換と呼び、$f^{*}_{L}(\eta)$のことを共役関数と呼ぶ。また、元の関数$f(x)_{L}$が凸関数の場合、共役関数の共役関数つまり、$f^{*}_{L}(\eta)$の共役関数$f^{**}_{L}$は元の関数と一致するという性質を持つ。

\subsection{$q$-loss関数へのLegendre変換の適用}
先行研究では、式を凸関数の形に変換した後にLegendre変換と式変形を行うことで、次のようなQUBO形式への変換を行なった。
\begin{eqnarray}
 L_{q}(m) = \min_{t}{\left\{(m-t)^{2}+(1-q)^{2}\frac{1-\mathrm{sign}(t-1)}{2}\right\}} \nonumber
\end{eqnarray}
ここで、変数$t$はLegendre変換を適用することで追加された変数である。また、$m,t$は連続変数であるが、二進数展開を用いることで二体相互作用で表現可能であり、sign関数についても一体相互作用で表現することができる。

\section{l1ノルムの素朴なQUBO形式での導出}
l1ノルム関数$f(m)$は式と定義され、グラフの外形は次のようになる。
\begin{eqnarray}
 f(m) = -\min{[-m,m]}
\end{eqnarray}
式にLegendre変換を適用すると二次形式は次のようになる。
\begin{eqnarray}
 F(m) = -\min{\{-mt\}} \quad (-1\leq t\leq 1)
\end{eqnarray}
なお、$f(m)$の二次形式であることを強調するために、$F(m)$とおく。

以上のように、$f(m)$のを二次形式で表現することができたが、$F(m)$の$\min$関数マイナス符号が付いているため、他のコスト関数と組み合わせた最適化問題を解くことができない。そこで、新たにWolfeの双対定理を適用する。Wolfeの双対定理の詳細については次の節で説明する。
\subsection{Wolfeの双対定理}
Wolfeの双対定理は、次のような不等式制約付き最適化(最大化)問題を、最大化(最適化)問題に書き換える物である。
\begin{equation}
  \left \{
  \begin{array}{lll}
    $minimize$_{x} & f_{w}(x) & (x\in\mathbb{R}^{n}) \\
    $subject to$ & h_{i}(x)\leq 0 & (i=1,2,\cdots,l)
  \end{array}
  \right. \notag
\end{equation}
この最適化問題に対するラグランジュ関数は次のように表される。
\begin{equation}
  L(x,z)=f_{w}(x)+z^{T}h(x) \notag
\end{equation}
このラグランジュ関数とラグランジュ乗数$z\in\mathbb{R}^{l}$に対して、双対問題は次のように表される。
\begin{equation}
  \left \{
  \begin{array}{lll}
    $maximize$_{x,z} & L(x,z) & ((x,z)\in\mathbb{R}^{n}\times\mathbb{R}^{l}) \\
    $subject to$ & \triangledown L(x,z)=0 & (z\geq 0)
  \end{array}
  \right. \notag
\end{equation}

\subsection{l1ノルムへのWolfeの双対定理の利用}
ここで、式に対して前節で説明したWolfeの双対定理を適用するため$F(m)$を式の形式に書き換えると次のようになる。
\begin{equation}
  \left \{
  \begin{array}{ll}
    $minimize$_{t} & -mt \\
    $subject to$ & h_{1}(t)=-(t+1)\leq 0, \\
    & h_{2}(t)=t-1\leq 0 \label{Wolfe_befor}
  \end{array}
  \right.
\end{equation}
Wolfeの双対定理を用いて最適化問題(\ref{Wolfe_befor})の双対問題を求めると次のようになる。
\begin{equation}
  \left \{
  \begin{array}{ll}
    $maximize$_{t,z} & -mt-z_{1}(t+1)+z_{2}(t-1) \\
    $subject to$ & -m-z_{1}+z_{2}=0 \\
    & (z_{1}\geq 0,z_{2}\geq 0) \label{Wolfe_after}
  \end{array}
  \right.
\end{equation}
なお、最適化問題(\ref{Wolfe_after})をQUBO形式にするためには、目的関数と制約条件を１つの式にまとめる必要がある。そのため最適化問題の式に制約条件を満たすように次のペナルティ項を加える。
\begin{eqnarray}
  -M(-m-z_{1}+z_{2})^{2}
\end{eqnarray}
ここで、$M$は非常に大きな正の数とする。他の制約条件$-t\leq t\leq 1,z_{1}\geq 0,z_{2}\geq 0$については、二進数展開時に対応する値しか取らないように展開することで対応できる。

以上より、l1ノルム関数のQUBO形式は次のようになる。
\begin{eqnarray}
    F(m) = \min_{t,z_{1},z_{2}}{\{mt+z_{1}(t+1)-z_{2}(t-1)} \nonumber \\
    +M(-m-z_{1}+z_{2})^{2}\} \label{l1_norm}
\end{eqnarray}

\section{余分な変数の削除}
この章では、前章で導出した式(\ref{l1_norm})に対して数式の見直しを行う。

制約条件の１つである$-m-z_{1}+z_{2}=0$を用いることで、式(\ref{l1_norm})の目的関数部は次のように式変形できる。
\begin{eqnarray}
  Obj &=& mt+z_{1}(t+1)-z_{2}(t-1) \nonumber \\
  &=& mt+z_{1}(t+1)-(m+z_{1})(t-1) \nonumber \\
  &=& z_{1}+(m+z_{1}) \nonumber \\
  &=& z_{1}+z_{2}
\end{eqnarray}
よって、式(\ref{l1_norm})は次のようになる。
\begin{eqnarray}
  F(m) = \min_{z_{1},z_{2}}{\{z_{1}+z_{2}+M(-m-z_{1}+z_{2})^{2}\}} \nonumber \\
  \label{l1}
\end{eqnarray}

\section{スパース推定への適用}
この章では導出された二次形式のl1ノルムを利用てスパース推定を行う。LASSOの二次形式のコスト関数は式(\ref{l1})を用いて次のように表せる。
\begin{eqnarray}
  S_{\lambda}(\beta) &=& \|y-X\beta\|^{2}_{2} \nonumber \\
  & & \mbox{}+\sum_{i=1}^{p}{\min_{z_{1i},z_{2i}}{\{z_{1i}+z_{2i}}} \nonumber \\
  & & \mbox{}+M(-\beta_{i}-z_{1i}+z_{2i})^{2}\} \label{lasso_cost}
\end{eqnarray}
以降の節では、数値実験で利用したデータセットと実験の詳細についての説明を行う。

\subsection{データセット}
実験で利用するデータセットは次のように作成した。計画行列を$\mathcal{N}(0,1)$に従う$X\in\mathbb{R}^{300\times 5}$の行列、解を$\mathcal{U}(-10,10)$に従う$\beta\in\mathbb{R}^{5}$のベクトル、ノイズを$\mathcal{N}(0,0.1)$に従う$\epsilon\in\mathbb{R}^{300}$のベクトルと設定し、観測ベクトル$y\in\mathbb{R}^{300}$を次のようにとる。
\begin{equation}
  y = X\beta +\epsilon
\end{equation}

\subsection{実験の詳細}
実験では連続値を用いて座標降下法とシミュレーテッドアニーリングでの比較を行なった。シミュレーテッドアニーリングの詳細は以下のようにした。
%\begin{items}
 % \item 反復回数；5,000,000回
  %\item 
%\end{items}

lassoの問題設定について
最小二乗法の数値実験の結果比較を載せる。連続値に対してはうまくいっていることが確認できている。

\section{まとめと今後の展望}

\ack %% 謝辞

%\bibliographystyle{sieicej}
%\bibliography{myrefs}
\begin{thebibliography}{99}% 文献数が10未満の時 {9}
\bibitem{}
\end{thebibliography}

\appendix
\section{}

\begin{biography}
%\profile*{}{}{}
%\profile{会員種別}{名前}{紹介文}% 顔写真あり
%\profile*{会員種別}{名前}{紹介文}% 顔写真なし
\end{biography}

\end{document}
