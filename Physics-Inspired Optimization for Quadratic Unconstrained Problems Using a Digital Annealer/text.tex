DAを用いた二次無制約問題のための物理学にヒントを得た最適化
要約

富士通のデージタルアニーラはフルコネクトでQUBO問題を解くために設計されている.
現在1024変数までの問題を解く. 
DAはSAを元にしているが効率的な並列試行方式と動的エスケープメカニズムを利用している. 

実験の結果
SAと並列焼き戻しシングルコアの実装に対してDAは, 現在のバイモーダルまたはガウスカップリングによる完全結合スピングラス問題に対して, 約二桁の時間短縮を実現した. 
だが, 疎な二次元スピングラス問題に対してはスピードアップを示さない. 
また, パラレルテンパリングデジタルアニーラの早期実装のベンチマークも実施した. 
その結果, 二峰性障害を伴う平均困難性の完全に関連した問題に対して, 他のアルゴリズムよりも良い結果を示唆した. 

1. Introduction 要約
量子アニーラの利点を探す努力が続けられているが, まだ見つかっていない. 
ベンチマークに対してSAのような古典的なものと量子アニーラとで比較すると量子アニーラによってアップが見られていたが, その後, より強力な古典的アルゴリズムが考えれて効率的に解けるようになった.

富士通ラボラトリーズはDAとして知られる完全接続されたQUBO問題を解くCMOSハードウェアを開発した. 
DAはSAを参考にしているが大規模な並列が利用できる点で異なる. 
DAに加えて, PTDAと呼ぶアルゴリズムエンジンに並列焼き戻しモンテカルロを使用するDAのバージョンが利用可能である. 
SAや焼き戻しモンテカルロなどの最適化技術はD-waveなどの量子ハードの性能を凌駕している. 
本稿では, スピングラス問題についてDAとPTDAをベンチマークし, 等エネルギークラスタ移動を用いたSAおよび並列焼き戻しモンテカルロとを比較する. 

第2章ではベンチマークで利用したアルゴリズムについての説明
第3章では並列焼き戻しの利点を検証する. 
第4章では計算時間を計測するために使用する方法についての説明. 
第5章ではベンチマークされた問題を紹介する. 
第6章では実験結果を提示し議論する. 
第7章ではその結果を示す. 

2. Algorithms 利用するアルゴリズム

B. デジタルアニーラのアルゴリズム
DAのアルゴリズムはSAに基づいているが以下の3点で異なる. 
・任意の状態から全ての実行を開始する
・各モンテカルロステップが全ての変数の反転を並列して考慮する並列試行方式を使用する
・DAは動的オフセットと呼ばれるエスケープメカニズムを採用している

C. Parallel Tempering with Isoenergetic Cluster Moves 等エネルギクラスタ移動による並列焼き戻し
PTは温度空間内をランダムに移動し, 一時的に高温に移動することでエネルギー障壁を克服できる. 
ICMをPTに追加することで一度に複数の変数を反転させることができる. 

D. The Parallel Tempering Digital Annealer's Algorithm
DAのアルゴリズムはSAに基づいており, PTがSAよりも優れた結果をもたらすことが多いため(たとえば, 参考文献[30]を参照), Fufitsu Laboratories は Parallel Tempering Digital Annealer(PTDA)も開発した. 
私たちはPTDAの早期実施へのアクセスを持っていた. 
PTDAでは, パラレルトライアル方式, パラレルアップデート, 動的オフセットメカニズムの使用など, 各レプリカのスイープはDAと同様に実行されるが, PT移動はCPU上で実行される. 


3. Parallel-trial Versus Single-trial Monte Carlo
システムの温度による一回の試行ごとの単一試行と並列試行の許容確率を測定する. 
その時の結果が図1である. 
また, 並列試行の優位性を考えるために, 図2のように並列試行の許容確率を単一試行の許容確率で割った値を示した. 

4. Scaling Analysis
ベンチマークの目的は, 問題サイズが増加するにつれて, 計算量がどの程度拡大するかを定量化することである. 
一般的アプローチは0.999の確率で少なくとも一回, 参照コストを見つけるために必要な合計時間を測定するので, この時間をTTSで計算する. 

TTSを導出する手順はDAとPTDAとで異なる. 

5. Benchmarking Problems
ベンチマークで使用する問題について. 

二次元-二峰性
  二峰性分布に従って結合が選択されるトーラス(周期的境界)上の二次元スピングラス問題. すなわち, それらは等しい確率で{-1,1}から値をとる. 
  
二次元-ガウス
  結合が10^5でスケールされた, 平均0で標準偏差が1のガウス分布から選択される二次元スピングラス問題. 
  
SK-二峰性-完全グラフ上のスピングラス問題 - 別名Sherrington-Krikpatrick(SK)スピングラス問題
  カップリングは二峰性分布に従って選択される. つまり, それらは等しい確率で{-1,1}から値をとる. 
  
SK-ガウス
  結合が平均0標準偏差1のガウス分布から選択されるSKスピングラス問題でありスケールは10^5

SK問題は二次元問題よりも困難であり, 15分の制限時間内に最適な解を見つけられなかったので, 64個の変数をもつSK問題について, それぞれ最適解を見つけるためにBiq Mac Solver と Biq Crunch による半正定値分岐限定法を使用した. 

6. Results and Discussion
本稿の全てのTTSプロットでのエラーバーはTTSプンプの平均と5番目と95番目の百分位数を表している. 

A. 二次元スピングラス問題を解いた時の結果
PT+ICMはどの問題に対しても低いTTSを持ち, 明確な利点がある. 
SAは小規模の問題ではTTSが低くなるが, サイズが大きくなるとDAとSAは同等のTTSを示す. 
しかし, DAは現在の精度限界でもSAよりも優れている. 
反復回数を10^7に増やしたが, サイズが400以上の二次元ガウス問題の80%以上を解くことができなかった

二次元二峰性問題について
図4aでは, 与えられた問題のサイズとスイープ数に対して, DAはSAよりも高い成功確率に達している. 
問題サイズが大きくなるにつれてDAとSAの平均成功曲線の差はそれほど顕著にならない. 
図4bは, サイズ0124の100個の問題インスタンスのうち52個の問題インスタンスに対してより高い成功確率をもたらした. 

二次元二峰性問題に対しては, DAの利点を示すことができなかった. 

二次元ガウス問題について
DA, SA共に性能は著しく低いがDAはSAよりも優位性がある. 
図5は, 最大の問題サイズに対する1024個の変数を持つ,検出された最小エネルギーのカイト参照エネルギーの解の間の相対エネルギー差(パーセント)である残留エネルギー(E)を示してる. 
これより, DAがSAよりも優れていることがわかる. 
また, 図6は, ガウス問題に対しては並列試行方式の方が効果的であることを示している.
図6bにおける400個の変数を有する100個の二次元ガウス問題インスタンスの成功確率相関は, DAがより高い成功確率に到達し, それがより低いTTSをもたらすことをさらに実証する.(図3b)

B. SKスピングラス問題の結果
SK二峰性問題の場合について, DAのTTS分布, PTDA, およびにSAおよびPTアルゴリズムの統計が図7aに示されている. 
DAとSAおよびPTを比較すると, 最大の問題サイズに近づくにつけて, DAによって少なくとも二桁の顕著で一貫したスピードアップが得られることがわかる. 
完全に接続された問題では, モンテカルロアルゴリズムのCPU実装で移動を受け入れて有効なローカルフィールドを更新することは, スパース問題よりも計算コストが高くなる. 

図7aは, 各アルゴリズムが全ての問題サイズについてSKインスタンスの少なくとも80%を解いたことを示している. 
これは, 完全なグラフ問題の参照エネルギーが厳密な最適解の上限であるという事実に起因する. 
上限がどれほど厳密化はわからないが, それは, 私たちが知る限りで最もよく知られている解き方を示している.

スケーリングに関する洞察を得るために, 各アルゴリズムについて, y=10^α+βNの形の指数関数を当てはめた. 
ここで, yおよびNはそれぞれTTS分布の平均および変数の数である. 
図7bは, TTS分布の50パーセンタイルおよび80パーセンタイルの統計に基づくある午後リズムについての推定スケーリング指数βの90%信頼区間を示す. 
50パーセンタイルではPTDAがバイモーダル無秩序の問題クラスに対して他の三つのアルゴリズムより優れたスケーリングをもたらすことがわかった. 
80パーセンタイルでは, 推定スケーリング指数の90%信頼区間が重なっているため, どのアルゴリズムがより適切にスケールするかについての結論を引き出すための十分な証拠はない. 
しかし, PTDAは最低点の見積もりを持っている. 

DA, SA, およびPTアルゴリズムでは, PTDAのパラメータはハードウェアによって自動的に解かれるのに対して, 実験的に最適なパラメータセットを決定するために多数のパラメータの組み合わせを検索した. 
我々はさらに実験的に四つ全てのアルゴリズムに対する最適な掃引数を決定した. 
しかしながら, 我々はパラメータの最適ではない調整のためにアルゴリズムのスケーリングが最適ではないかもしれないという可能性を除外しない. 
例えば, PTDAのスケーリングはそのパラメータを調整した後に改善され得, そしてPTはより最適化された温度スケジュールを使用してより良好なスケーリングを示し得る. 

図8はDA, SA, PTおよびPTDAによって解決されるSKガウス問題インスタンスのTTS統計とスケーリング指数の信頼区間を示している. 
ガウシアン無秩序のあるスピングラス問題を解く際に, DAは他のアルゴリズムに比べて少なくとも二桁の一定のスピードアップを示しており, 強いスケーリングの利点はない. 


The DA versus SA
DAはSK二峰性問題インスタンスおよびSKガウス問題インスタンスの両方について, SAよりも低いTTSをもたらす. 
この動作の理由は二つある. 
第一に, DAのアニール時間は変数の数および問題の密度とは無関係であるのに対して, SAにおける掃引の計算時間は問題のサイズおよび問題の密度とともに増加する. 
第二に, 図9に示すように, 並列試行方式は, 二峰性およびガウス性の両方の無秩序を有するサイズ1024の完全連結スピングラス問題における成功確率を著しく改善する. 

C. Spin-Glass Problems with Different Dennsities
図10は, 様々な問題密度に対するDAとSAのTTSの統計を示している. 
密度スペクトルの限界を表す, 問題サイズが1024の場合の二次元バイモーダル(d=0.4%)およびSKバイモーダル(d=100%)のTTS結果も含まれている. 
DAは最もまばらな問題セット(二次元二峰性)を除く全ての問題密度でSAよりもTTSが低くなる. 
TTS80分布の統計を推定するために, DAおよびSAを使用して, 十分な二次元二峰性インスタンスが最適性になるように解決されなかった.

図11は, 密度が異なる, サイズが1024のスピングアス問題が100個発生する場合の成功確率をDAとSAで解いたものである. 
DAは, 最もまばらな問題のセットである二次元バイモーダルを除いて, 全ての密度に対して統計的に有意なマージンでSAよりも高い成功確率を示している. 
これらの結果は, 並列試行方式を使用することによる成功確率の増加と, DAハードウェアアーキテクチャで各モンテカルロステップを実行するのに必要な一定時間の両方が原因であると解釈する. 

7. Conclusions and Outlook
この研究では, 等エネルギークラスタ移動(PT+IMCとPT)およびシミュレーテッドアニーリング(SA)の有無による並列焼き戻しモンテカルロに対するデジタル焼鈍(DA)および並列焼き戻しデジタル焼鈍(PTDA)の性能を比較した. 
二峰性およびガウス性の無秩序を伴う, 疎で完全に結合したスピングラス問題のランダムなインスタンスを利用する. 

本発明者らの結果は, 密な問題を解く際にDAがSAおよびPTよりもおよそ二桁速いことを証明しているが, それはまばらな問題のためのスピードアップを示さない. 後者の問題クラスでは, PTアルゴリズムへのクラスター更新の追加は, DAやSAのように単一のプリップ近傍に作用するアルゴリズムよりも優れたエネルギー障壁を通過するのに非常に効率的である. 密集した問題の場合, 並列試行方式と特定用途向けCMOSハードウェアで可能な大規模な並列化が組み合わされているため, クラスタ移動の効率が低下してDAが速くなる. 我々の結果はさらに, DAが10%以上の密度のランダムスピングラス問題においてSAよりも有利であるという立場を支持する. 

三章では, パラレルトライアルモンテアカルロが標準的な更新スキームよりも受け入れ確率を大幅に高めることができることを示している. さらに, このブーストは高温で消滅し, 基底状態の縮退が大きい問題では減少することを示している. 我々のベンチマークの結果は, 容認された動きは状態配置を変えるだけではなくエネルギー値を下げることに伴いそうなるので, 並列試行方式が低い基底状態縮退を伴う問題を解くのにより効果的であるという見解をさらに裏付ける. 

現在のPTDAの初期の実装では, PT移動を実行する際のCPUオーバーヘッドのために, TTSは将来よりも大きくなる可能性がある. しかしながら, PTDAアルゴリズムは, 二峰性カップリングを伴う平均計算困難性の完全接続スピングラス問題に対して他の三つのアルゴリズムよりも優れたスケーリングを示す. 

次世代のデジタルアニーラでは, ハードウェアアーキテクチャにより, 最大8192個の完全に接続された変数を使用して問題を最適化することが期待されている. さらに, アニーリング時間は減少すると予想され, そして我々はそれに応じてTTSが減少するかもしれないと予測する. 最後に, PTDA内でのレプリカ交換の移動がハードウェア上で実行されることを期待している. これにより, PTDAのパフォーマンスが向上する可能性がある. 

我々の結果は, 特定用途向けCMOSハードウェアと物理学にヒントを得た最適化手法を組み合わせることで, 非常に効率的な専用の最適化装置が得られることを示している. 
完全に接続されたトポロジーと高いデジタル精度のために, これらの機械は現在のアナログ量子最適化機械を凌駕する可能性を秘めている. 
そのような特定用途向けCMOSハードウェアを高速相互接続と組み合わせることは, 大規模な変換最適化装置をもたらす可能性がある. 
そのため, 次世代のヂジタルアニーラは, 従来のCPUハードウェアでは不可能であった基本的な物理問題と産業用アプリケーションの研究への道を開くものと期待されている. 






